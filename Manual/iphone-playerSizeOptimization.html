<!DOCTYPE html><html class="no-js" lang="zh-cn">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-5V25JL6');
    </script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="twitter:card" content="summary">
<meta name="robots" content="noindex">
<meta property="og:title" content="Optimizing the size of the built iOS player - Unity 手册">
<title>Optimizing the size of the built iOS player - Unity 手册</title>
<meta name="description" content="The two main ways of reducing the size of the player are by making proper Release build within Xcode and by changing the Stripping Level within Unity.">
<meta property="og:description" content="The two main ways of reducing the size of the player are by making proper Release build within Xcode and by changing the Stripping Level within Unity.">
<meta name="author" content="Unity Technologies">
<link rel="shortcut icon" href="../StaticFiles/images/favicons/favicon.ico">
<link rel="icon" type="image/png" href="../StaticFiles/images/favicons/favicon.png">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="../StaticFiles/images/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../StaticFiles/images/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="../StaticFiles/images/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../StaticFiles/images/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="../StaticFiles/images/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon-precomposed" href="../StaticFiles/images/favicons/apple-touch-icon.png">
<meta name="msapplication-TileColor" content="#222c37">
<meta name="msapplication-TileImage" content="../StaticFiles/images/favicons/tileicon-144x144.png">
<script>
      var docs_type = 'Manual';
      var lang = 'cn';
      var page = 'iphone-playerSizeOptimization';
      if(!page) page = 'index';
      var version = '560';
      var docs_versions = [{version: '2020.1',version_string: '2020.1'},{version: '2019.3',version_string: '2019.3'},{version: '2019.2',version_string: '2019.2'},{version: '2019.1',version_string: '2019.1'},{version: '2018.4',version_string: '2018.4'},{version: '2018.3',version_string: '2018.3'},{version: '2018.2',version_string: '2018.2'},{version: '2018.1',version_string: '2018.1'},{version: '2017.4',version_string: '2017.4'},{version: '2017.3',version_string: '2017.3'},{version: '2017.2',version_string: '2017.2'},{version: '2017.1',version_string: '2017.1'},{version: '5.6',version_string: '560'},];</script><script type="text/javascript" src="../StaticFiles/js/jquery.js"></script><script type="text/javascript" src="../StaticFiles/js/core.js"></script><script type="text/javascript" src="../StaticFiles/js/jquery.sidebar.min.js"></script><script type="text/javascript" src="docdata/toc.js"></script><script type="text/javascript" src=""></script><script type="text/javascript" src="../StaticFiles/js/custom.js"></script><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700,400italic" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="../StaticFiles/css/core.css">
<link rel="stylesheet" type="text/css" href="../StaticFiles/css/custom.css">
<link rel="canonical" href="https://docs.unity3d.com/cn/560/Manual/iphone-playerSizeOptimization.html">
<link rel="alternate" href="https://docs.unity3d.com/en/560/Manual/iphone-playerSizeOptimization.html" hreflang="en">
<link rel="alternate" href="https://docs.unity3d.com/ja/560/Manual/iphone-playerSizeOptimization.html" hreflang="ja">
<link rel="alternate" href="https://docs.unity3d.com/es/560/Manual/iphone-playerSizeOptimization.html" hreflang="es">
<link rel="alternate" href="https://docs.unity3d.com/kr/560/Manual/iphone-playerSizeOptimization.html" hreflang="ko">
<link rel="alternate" href="https://docs.unity3d.com/ru/560/Manual/iphone-playerSizeOptimization.html" hreflang="ru">
<link rel="alternate" href="https://docs.unity3d.com/560/Documentation/Manual/iphone-playerSizeOptimization.html" hreflang="x-default">
</head>
<body>
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5V25JL6" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<div class="header-wrapper">
<div id="header" class="header"><div class="content">
<div class="spacer"><div class="menu">
<div id="nav-open" for="nav-input"><span></span></div>
<div class="logo"><a href="http://docs.unity3d.com"></a></div>
<div class="search-form"><form action="30_search.html" method="get" class="apisearch">
<input type="text" name="q" placeholder="搜索手册..." autosave="Unity Reference" results="5" class="sbox field" id="q"><input type="submit" class="submit">
</form></div>
<ul class="menu-items">
<li class="menu-item"><a href="../Manual/index.html" class="selected">手册</a></li>
<li class="menu-item"><a href="../ScriptReference/index.html" class="">脚本 API</a></li>
</ul>
</div></div>
<div class="more">
<div class="filler"></div>
<ul><li><a href="https://unity3d.com/">
                unity3d.com
              </a></li></ul>
</div>
</div></div>
<div class="toolbar"><div class="content">
<div class="version-switcher">
<div class="current toggle" data-target=".version-list"><div class="version-number">
<div class="d-inline-block">
          Version:
          <b>5.6</b>
</div>
<div class="d-inline-block arrow"></div>
</div></div>
<div class="version-list" style="display:none;"><ul>
<li><a class="docs_version_url_2020.1" href="/cn/2020.1/Manual/iphone-playerSizeOptimization.html">2020.1</a></li>
<li><a class="docs_version_url_2019.3" href="/cn/2019.3/Manual/iphone-playerSizeOptimization.html">2019.3</a></li>
<li><a class="docs_version_url_2019.2" href="/cn/2019.2/Manual/iphone-playerSizeOptimization.html">2019.2</a></li>
<li><a class="docs_version_url_2019.1" href="/cn/2019.1/Manual/iphone-playerSizeOptimization.html">2019.1</a></li>
<li><a class="docs_version_url_2018.4" href="/cn/2018.4/Manual/iphone-playerSizeOptimization.html">2018.4</a></li>
<li><a class="docs_version_url_2018.3" href="/cn/2018.3/Manual/iphone-playerSizeOptimization.html">2018.3</a></li>
<li><a class="docs_version_url_2018.2" href="/cn/2018.2/Manual/iphone-playerSizeOptimization.html">2018.2</a></li>
<li><a class="docs_version_url_2018.1" href="/cn/2018.1/Manual/iphone-playerSizeOptimization.html">2018.1</a></li>
<li><a class="docs_version_url_2017.4" href="/cn/2017.4/Manual/iphone-playerSizeOptimization.html">2017.4</a></li>
<li><a class="docs_version_url_2017.3" href="/cn/2017.3/Manual/iphone-playerSizeOptimization.html">2017.3</a></li>
<li><a class="docs_version_url_2017.2" href="/cn/2017.2/Manual/iphone-playerSizeOptimization.html">2017.2</a></li>
<li><a class="docs_version_url_2017.1" href="/cn/2017.1/Manual/iphone-playerSizeOptimization.html">2017.1</a></li>
<li><a class="docs_version_url_560" href="/cn/560/Manual/iphone-playerSizeOptimization.html">5.6</a></li>
</ul></div>
</div>
<ul class="nav-menu-items">
<li class="menu-item"><a href="../Manual/index.html" class="selected">手册</a></li>
<li class="menu-item"><a href="../ScriptReference/index.html" class="">脚本 API</a></li>
</ul>
<div class="lang-switcher">
<div class="current toggle" data-target=".lang-list">
<div class="lbl">语言:
        <span class="b">中文</span>
</div>
<div class="arrow"></div>
</div>
<div class="lang-list" style="display:none;"><ul>
<li><a data-lang="en" href="/560/Documentation/Manual/iphone-playerSizeOptimization.html">English</a></li>
<li><a data-lang="ja" href="/ja/560/Manual/iphone-playerSizeOptimization.html">日本語</a></li>
<li><a data-lang="es" href="/es/560/Manual/iphone-playerSizeOptimization.html">Español</a></li>
<li><a data-lang="kr" href="/kr/560/Manual/iphone-playerSizeOptimization.html">한국어</a></li>
<li><a data-lang="ru" href="/ru/560/Manual/iphone-playerSizeOptimization.html">Русский</a></li>
</ul></div>
</div>
</div></div>
</div>
<div id="master-wrapper" class="master-wrapper clear">
<div id="sidebar" class="sidebar hidden"><div class="sidebar-wrap"><div class="content"><div class="sidebar-menu"><div class="toc">
<h2>手册</h2>
<div class="version-switcher">
<div class="current toggle" data-target=".version-list"><div class="version-number">
<div class="d-inline-block">
          Version:
          <b>5.6</b>
</div>
<div class="d-inline-block arrow"></div>
</div></div>
<div class="version-list" style="display:none;"><ul>
<li><a class="docs_version_url_2020.1" href="/cn/2020.1/Manual/iphone-playerSizeOptimization.html">2020.1</a></li>
<li><a class="docs_version_url_2019.3" href="/cn/2019.3/Manual/iphone-playerSizeOptimization.html">2019.3</a></li>
<li><a class="docs_version_url_2019.2" href="/cn/2019.2/Manual/iphone-playerSizeOptimization.html">2019.2</a></li>
<li><a class="docs_version_url_2019.1" href="/cn/2019.1/Manual/iphone-playerSizeOptimization.html">2019.1</a></li>
<li><a class="docs_version_url_2018.4" href="/cn/2018.4/Manual/iphone-playerSizeOptimization.html">2018.4</a></li>
<li><a class="docs_version_url_2018.3" href="/cn/2018.3/Manual/iphone-playerSizeOptimization.html">2018.3</a></li>
<li><a class="docs_version_url_2018.2" href="/cn/2018.2/Manual/iphone-playerSizeOptimization.html">2018.2</a></li>
<li><a class="docs_version_url_2018.1" href="/cn/2018.1/Manual/iphone-playerSizeOptimization.html">2018.1</a></li>
<li><a class="docs_version_url_2017.4" href="/cn/2017.4/Manual/iphone-playerSizeOptimization.html">2017.4</a></li>
<li><a class="docs_version_url_2017.3" href="/cn/2017.3/Manual/iphone-playerSizeOptimization.html">2017.3</a></li>
<li><a class="docs_version_url_2017.2" href="/cn/2017.2/Manual/iphone-playerSizeOptimization.html">2017.2</a></li>
<li><a class="docs_version_url_2017.1" href="/cn/2017.1/Manual/iphone-playerSizeOptimization.html">2017.1</a></li>
<li><a class="docs_version_url_560" href="/cn/560/Manual/iphone-playerSizeOptimization.html">5.6</a></li>
</ul></div>
</div>
<div class="clear"></div>
</div></div></div></div></div>
<div id="content-wrap" class="content-wrap opened-sidebar"><div class="content-block"><div class="content">
<div class="section">
<div class="breadcrumbs clear"><ul>
<li><a href="UnityManual.html">Unity User Manual (5.6)</a></li>
<li><a href="PlatformSpecific.html">特定于平台的信息</a></li>
<li><a href="iphone.html">iOS</a></li>
<li>iOS 高级主题</li>
<li><a href="iphone-performance.html">Optimizing Performance in iOS.</a></li>
<li>Optimizing the size of the built iOS player</li>
</ul></div>
<div class="mb20"><div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="iphone-InternalProfiler.html"></a></span><div class="tip">Measuring Performance with the Built-in Profiler</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="iphone-Optimizing-Physics.html"></a></span><div class="tip">优化物理性能</div>
</div>
</div></div>
<h1>Optimizing the size of the built iOS player</h1>
<!--BeginSwitchLink--><!--EndSwitchLink-->
<div class="clear"></div>

<p>The two main ways of reducing the size of the player are by making proper <strong>Release build</strong> within Xcode and by changing the <strong>Stripping Level</strong> within Unity.</p>

<h2>为分发进行构建</h2>

<p>It is expected that final release builds are made using Xcode 4.x/5.x command <strong>Product -&gt; Archive</strong>. Using this command ensures that build is made with release configuration <strong>and</strong> all the debug symbols are stripped.
After issuing this command latest Xcode switches to Organizer window <strong>Archives</strong> tab (you can navigate there manually via <em>Window -&gt; Organizer</em> menu). You will find there two very useful functions there: <strong>App Store size estimation</strong> and <strong>Distribution</strong>.
Build size estimation function works pretty well, but it is always recommended to have some small extra margin for error when aiming for 3G download limit (which currently is 100MB).</p>

<h2>iOS 剥离级别</h2>

<p>The size optimizations activated by stripping work in the following way:</p>

<p>1.<strong>Strip assemblies</strong> 级别：分析脚本的字节码，以便可从 DLL 中删除未在脚本中引用的类和方法，从而在 AOT 编译阶段中将它们排除。此优化可以减小主二进制文件和附带 DLL 的大小，只要不使用反射就是安全的。</p>

<p>1.<strong>Strip ByteCode</strong> 级别：所有 .NET DLL（存储在 Data 文件夹中）都会被剥离为仅剩下元数据。之所以可以这样做，是因为所有代码都已在 AOT 阶段预编译并链接到主二进制文件中。</p>

<p>1.<strong>Use micro mscorlib</strong> 级别：使用特殊的较小版本的 mscorlib。某些组件将从此库中删除，例如 Security、Reflection.Emit、Remoting、非 Gregorian 日历等。此外，内部组件之间的相互依赖关系将最小化。此优化可以减小主二进制文件和 mscorlib.dll 大小，但与某些 System 和 System.Xml 程序集类不兼容，因此请谨慎使用。</p>

<p>这些级别是累积的，因此级别 3 优化隐含地包括级别 2 和 1，而级别 2 优化包括级别 1。</p>

<p>请注意，__Micro mscorlib__ 是核心库的大幅度精简版本。只保留 Unity 中 Mono 运行时所需的项。使用 micro mscorlib 的最佳做法是不要使用应用程序不需要的任何类或其他 .NET 功能。GUID 就是一个可以省略的典型示例；很容易将它们替换为定制的伪 GUID，这样做可以带来更好的性能和更小的应用程序大小。</p>

<h2>使用 IL2CPP 进行剥离</h2>

<p>Refer to documentaiton on <a href="IL2CPP-BtyecodeStripping">managed bytecode stripping with IL2CPP</a> for more information</p>

<p><strong>Note:</strong> it can sometimes be difficult to determine which classes are getting stripped in error even though the application requires them. You can often get useful information about this by running the stripped application on the simulator and checking the Xcode console for error messages.</p>

<h3>关于使分发大小尽可能小的简单核对表</h3>

<ol>
<li>Minimize your assets: enable PVRTC compression for textures and reduce their resolution as far as possible. Also, minimize the number of uncompressed sounds. There are some additional tips for file size reduction <a href="ReducingFilesize.html">here</a>.</li>
<li>Set the iOS Stripping Level to <strong>Use micro mscorlib</strong>.
1.将脚本调用优化 (Script Call Optimization) 级别设置为 <strong>Fast but no exceptions</strong>。
1.不要在代码中使用 System.dll 或 System.Xml.dll 中的任何内容。这些库与 micro mscorlib <strong>不</strong>兼容。
1.删除不必要的代码依赖项。
1.将 API 兼容性级别 (API Compatibility Level) 设置为 <strong>.Net 2.0 subset</strong>。请注意，.Net 2.0 子集与其他库的兼容性有限。</li>
<li>Don’t use JS Arrays.
1.避免将通用容器与值类型（包括结构）结合使用。</li>
</ol>

<h3>使用 Unity 制作的应用程序最小为多大？</h3>

<p>如果关闭所有大小优化，则空项目在 App Store 中将小于 22 MB。进行代码剥离后，只包含主摄像机的空场景可以在 App Store 中减少到小于 12 MB（经过压缩并附加 DRM）。</p>

<h3>为什么我的应用程序在发布到 App Store 后会增大？</h3>

<p>发布应用程序时，Apple App Store 服务首先加密二进制文件，然后通过 zip 对其进行压缩。加密会增加代码段的“随机性”，从而使压缩效果变差。请查看上面的“为分发进行构建”一章，了解如何在提交前估计 App Store 大小。</p>

<hr>

<ul>
<li><p><span class="page-edit">2017–14–06 Page amended with no <a href="DocumentationEditorialReview.html">editorial review</a> - <a href="LeaveFeedback.html">Leave page feedback</a></span></p></li>
<li><p><span class="page-history">2017–14–06 - 更新了“使用 IL2CPP 进行剥离”部分</span></p></li>
</ul>
<div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="iphone-InternalProfiler.html"></a></span><div class="tip">Measuring Performance with the Built-in Profiler</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="iphone-Optimizing-Physics.html"></a></span><div class="tip">优化物理性能</div>
</div>
</div>
</div>
<div class="footer-wrapper">
<div class="footer clear">
<div class="copy">Copyright © 2017 Unity Technologies. Publication 5.6</div>
<div class="menu">
<a href="http://unity3d.com/learn">教程</a><a href="http://answers.unity3d.com">社区答案</a><a href="https://support.unity3d.com/hc/en-us">知识库</a><a href="http://forum.unity3d.com">论坛</a><a href="http://unity3d.com/asset-store">Asset Store</a>
</div>
</div>
<div></div>
</div>
</div></div></div>
</div>
</body>
</html>
