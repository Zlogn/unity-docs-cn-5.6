<!DOCTYPE html><html class="no-js" lang="zh-cn">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-5V25JL6');
    </script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="twitter:card" content="summary">
<meta name="robots" content="noindex">
<meta property="og:title" content="Windows Store Apps: Debugging on IL2CPP Scripting Backend - Unity 手册">
<title>Windows Store Apps: Debugging on IL2CPP Scripting Backend - Unity 手册</title>
<meta property="og:image" content="https://docs.unity3d.com/cn/5.6/uploads/Main/IL2CPP_Debugging_1.png">
<meta name="description" content="虽然 IL2CPP 目前没有 C# 调试器，但仍然可以使用 Visual Studio 调试生成的 C++ 代码。">
<meta property="og:description" content="虽然 IL2CPP 目前没有 C# 调试器，但仍然可以使用 Visual Studio 调试生成的 C++ 代码。">
<meta name="author" content="Unity Technologies">
<link rel="shortcut icon" href="../StaticFiles/images/favicons/favicon.ico">
<link rel="icon" type="image/png" href="../StaticFiles/images/favicons/favicon.png">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="../StaticFiles/images/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../StaticFiles/images/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="../StaticFiles/images/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../StaticFiles/images/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="../StaticFiles/images/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon-precomposed" href="../StaticFiles/images/favicons/apple-touch-icon.png">
<meta name="msapplication-TileColor" content="#222c37">
<meta name="msapplication-TileImage" content="../StaticFiles/images/favicons/tileicon-144x144.png">
<script>
      var docs_type = 'Manual';
      var lang = 'cn';
      var page = 'windowsstore-debugging-il2cpp';
      if(!page) page = 'index';
      var version = '560';
      var docs_versions = [{version: '2020.1',version_string: '2020.1'},{version: '2019.3',version_string: '2019.3'},{version: '2019.2',version_string: '2019.2'},{version: '2019.1',version_string: '2019.1'},{version: '2018.4',version_string: '2018.4'},{version: '2018.3',version_string: '2018.3'},{version: '2018.2',version_string: '2018.2'},{version: '2018.1',version_string: '2018.1'},{version: '2017.4',version_string: '2017.4'},{version: '2017.3',version_string: '2017.3'},{version: '2017.2',version_string: '2017.2'},{version: '2017.1',version_string: '2017.1'},{version: '5.6',version_string: '560'},];</script><script type="text/javascript" src="../StaticFiles/js/jquery.js"></script><script type="text/javascript" src="../StaticFiles/js/core.js"></script><script type="text/javascript" src="../StaticFiles/js/jquery.sidebar.min.js"></script><script type="text/javascript" src="docdata/toc.js"></script><script type="text/javascript" src=""></script><script type="text/javascript" src="../StaticFiles/js/custom.js"></script><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700,400italic" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="../StaticFiles/css/core.css">
<link rel="stylesheet" type="text/css" href="../StaticFiles/css/custom.css">
<link rel="canonical" href="https://docs.unity3d.com/cn/560/Manual/windowsstore-debugging-il2cpp.html">
<link rel="alternate" href="https://docs.unity3d.com/en/560/Manual/windowsstore-debugging-il2cpp.html" hreflang="en">
<link rel="alternate" href="https://docs.unity3d.com/ja/560/Manual/windowsstore-debugging-il2cpp.html" hreflang="ja">
<link rel="alternate" href="https://docs.unity3d.com/es/560/Manual/windowsstore-debugging-il2cpp.html" hreflang="es">
<link rel="alternate" href="https://docs.unity3d.com/kr/560/Manual/windowsstore-debugging-il2cpp.html" hreflang="ko">
<link rel="alternate" href="https://docs.unity3d.com/ru/560/Manual/windowsstore-debugging-il2cpp.html" hreflang="ru">
<link rel="alternate" href="https://docs.unity3d.com/560/Documentation/Manual/windowsstore-debugging-il2cpp.html" hreflang="x-default">
</head>
<body>
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5V25JL6" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<div class="header-wrapper">
<div id="header" class="header"><div class="content">
<div class="spacer"><div class="menu">
<div id="nav-open" for="nav-input"><span></span></div>
<div class="logo"><a href="http://docs.unity3d.com"></a></div>
<div class="search-form"><form action="30_search.html" method="get" class="apisearch">
<input type="text" name="q" placeholder="搜索手册..." autosave="Unity Reference" results="5" class="sbox field" id="q"><input type="submit" class="submit">
</form></div>
<ul class="menu-items">
<li class="menu-item"><a href="../Manual/index.html" class="selected">手册</a></li>
<li class="menu-item"><a href="../ScriptReference/index.html" class="">脚本 API</a></li>
</ul>
</div></div>
<div class="more">
<div class="filler"></div>
<ul><li><a href="https://unity3d.com/">
                unity3d.com
              </a></li></ul>
</div>
</div></div>
<div class="toolbar"><div class="content">
<div class="version-switcher">
<div class="current toggle" data-target=".version-list"><div class="version-number">
<div class="d-inline-block">
          Version:
          <b>5.6</b>
</div>
<div class="d-inline-block arrow"></div>
</div></div>
<div class="version-list" style="display:none;"><ul>
<li><a class="docs_version_url_2020.1" href="/cn/2020.1/Manual/windowsstore-debugging-il2cpp.html">2020.1</a></li>
<li><a class="docs_version_url_2019.3" href="/cn/2019.3/Manual/windowsstore-debugging-il2cpp.html">2019.3</a></li>
<li><a class="docs_version_url_2019.2" href="/cn/2019.2/Manual/windowsstore-debugging-il2cpp.html">2019.2</a></li>
<li><a class="docs_version_url_2019.1" href="/cn/2019.1/Manual/windowsstore-debugging-il2cpp.html">2019.1</a></li>
<li><a class="docs_version_url_2018.4" href="/cn/2018.4/Manual/windowsstore-debugging-il2cpp.html">2018.4</a></li>
<li><a class="docs_version_url_2018.3" href="/cn/2018.3/Manual/windowsstore-debugging-il2cpp.html">2018.3</a></li>
<li><a class="docs_version_url_2018.2" href="/cn/2018.2/Manual/windowsstore-debugging-il2cpp.html">2018.2</a></li>
<li><a class="docs_version_url_2018.1" href="/cn/2018.1/Manual/windowsstore-debugging-il2cpp.html">2018.1</a></li>
<li><a class="docs_version_url_2017.4" href="/cn/2017.4/Manual/windowsstore-debugging-il2cpp.html">2017.4</a></li>
<li><a class="docs_version_url_2017.3" href="/cn/2017.3/Manual/windowsstore-debugging-il2cpp.html">2017.3</a></li>
<li><a class="docs_version_url_2017.2" href="/cn/2017.2/Manual/windowsstore-debugging-il2cpp.html">2017.2</a></li>
<li><a class="docs_version_url_2017.1" href="/cn/2017.1/Manual/windowsstore-debugging-il2cpp.html">2017.1</a></li>
<li><a class="docs_version_url_560" href="/cn/560/Manual/windowsstore-debugging-il2cpp.html">5.6</a></li>
</ul></div>
</div>
<ul class="nav-menu-items">
<li class="menu-item"><a href="../Manual/index.html" class="selected">手册</a></li>
<li class="menu-item"><a href="../ScriptReference/index.html" class="">脚本 API</a></li>
</ul>
<div class="lang-switcher">
<div class="current toggle" data-target=".lang-list">
<div class="lbl">语言:
        <span class="b">中文</span>
</div>
<div class="arrow"></div>
</div>
<div class="lang-list" style="display:none;"><ul>
<li><a data-lang="en" href="/560/Documentation/Manual/windowsstore-debugging-il2cpp.html">English</a></li>
<li><a data-lang="ja" href="/ja/560/Manual/windowsstore-debugging-il2cpp.html">日本語</a></li>
<li><a data-lang="es" href="/es/560/Manual/windowsstore-debugging-il2cpp.html">Español</a></li>
<li><a data-lang="kr" href="/kr/560/Manual/windowsstore-debugging-il2cpp.html">한국어</a></li>
<li><a data-lang="ru" href="/ru/560/Manual/windowsstore-debugging-il2cpp.html">Русский</a></li>
</ul></div>
</div>
</div></div>
</div>
<div id="master-wrapper" class="master-wrapper clear">
<div id="sidebar" class="sidebar hidden"><div class="sidebar-wrap"><div class="content"><div class="sidebar-menu"><div class="toc">
<h2>手册</h2>
<div class="version-switcher">
<div class="current toggle" data-target=".version-list"><div class="version-number">
<div class="d-inline-block">
          Version:
          <b>5.6</b>
</div>
<div class="d-inline-block arrow"></div>
</div></div>
<div class="version-list" style="display:none;"><ul>
<li><a class="docs_version_url_2020.1" href="/cn/2020.1/Manual/windowsstore-debugging-il2cpp.html">2020.1</a></li>
<li><a class="docs_version_url_2019.3" href="/cn/2019.3/Manual/windowsstore-debugging-il2cpp.html">2019.3</a></li>
<li><a class="docs_version_url_2019.2" href="/cn/2019.2/Manual/windowsstore-debugging-il2cpp.html">2019.2</a></li>
<li><a class="docs_version_url_2019.1" href="/cn/2019.1/Manual/windowsstore-debugging-il2cpp.html">2019.1</a></li>
<li><a class="docs_version_url_2018.4" href="/cn/2018.4/Manual/windowsstore-debugging-il2cpp.html">2018.4</a></li>
<li><a class="docs_version_url_2018.3" href="/cn/2018.3/Manual/windowsstore-debugging-il2cpp.html">2018.3</a></li>
<li><a class="docs_version_url_2018.2" href="/cn/2018.2/Manual/windowsstore-debugging-il2cpp.html">2018.2</a></li>
<li><a class="docs_version_url_2018.1" href="/cn/2018.1/Manual/windowsstore-debugging-il2cpp.html">2018.1</a></li>
<li><a class="docs_version_url_2017.4" href="/cn/2017.4/Manual/windowsstore-debugging-il2cpp.html">2017.4</a></li>
<li><a class="docs_version_url_2017.3" href="/cn/2017.3/Manual/windowsstore-debugging-il2cpp.html">2017.3</a></li>
<li><a class="docs_version_url_2017.2" href="/cn/2017.2/Manual/windowsstore-debugging-il2cpp.html">2017.2</a></li>
<li><a class="docs_version_url_2017.1" href="/cn/2017.1/Manual/windowsstore-debugging-il2cpp.html">2017.1</a></li>
<li><a class="docs_version_url_560" href="/cn/560/Manual/windowsstore-debugging-il2cpp.html">5.6</a></li>
</ul></div>
</div>
<div class="clear"></div>
</div></div></div></div></div>
<div id="content-wrap" class="content-wrap opened-sidebar"><div class="content-block"><div class="content">
<div class="section">
<div class="breadcrumbs clear"><ul>
<li><a href="UnityManual.html">Unity User Manual (5.6)</a></li>
<li><a href="PlatformSpecific.html">特定于平台的信息</a></li>
<li><a href="Windows.html">Windows</a></li>
<li><a href="WindowsStore.html">Windows Store Apps</a></li>
<li><a href="windowsstore-scriptingbackends.html">脚本后端</a></li>
<li><a href="windowsstore-il2cpp.html">Windows Store: IL2CPP scripting back end</a></li>
<li>Windows Store Apps: Debugging on IL2CPP Scripting Backend</li>
</ul></div>
<div class="mb20"><div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="windowsstore-plugins-il2cpp.html"></a></span><div class="tip">Windows Store: Plugins on IL2CPP Scripting Backend</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="windowsstore-faq.html"></a></span><div class="tip">常见问题解答</div>
</div>
</div></div>
<h1>Windows Store Apps: Debugging on IL2CPP Scripting Backend</h1>
<!--BeginSwitchLink--><!--EndSwitchLink-->
<div class="clear"></div>

<p>虽然 IL2CPP 目前没有 C# 调试器，但仍然可以使用 Visual Studio 调试生成的 C++ 代码。</p>

<h2>生成的 C++ 代码中的类和方法命名</h2>

<p>IL2CPP 类如下所示：<code>&lt;ClassName&gt;_t#number</code>，其中的 <code>&lt;ClassName&gt;</code> 是类的普通名称，而 #number 是唯一的类型编号。某些核心类型不存在 #number。例如：</p>

<pre><code>String_t
Object_t
Type_t
Char_t34
StringBuilder_t26
GuidParser_t1539
</code></pre>

<p>IL2CPP 方法如下所示：<code>&lt;ClassName&gt;_&lt;MethodName&gt;_m#number</code>，其中的 <code>&lt;ClassName&gt;</code> 是声明类型的方法的普通类名，<code>&lt;MethodName&gt;</code> 是普通方法名称，而 <code>#number</code> 是唯一的方法编号。例如：</p>

<pre><code>GuidParser_ParseHex_m10003
ConfigurationSection_DoDeserializeSection_m1275
String_Format_m4102
Mathf_Sqrt_m289
Thing_Start_m1
</code></pre>

<p>静态字段结构的命名如下所示：<code>&lt;ClassName&gt;_t#number_StaticFields</code>，其中结构名称的第一部分与声明类型相同，例如：</p>

<pre><code>StringBuilder_t26_StaticFields
Thing_t24_StaticFields
</code></pre>

<p>此外，在每个类/方法定义上面都有一条 C++ 注释，指出完整的类/方法名称。例如：</p>

<pre><code>// System.String
struct String_t : public Object_t
{
    // System.Int32 System.String::length
    int32_t **_length_0;
    // System.Char System.String::start_char
    uint16_t **_start_char_1;
};

// System.Text.StringBuilder
struct StringBuilder_t26  : public Object_t
{
    // System.Int32 System.Text.StringBuilder::_length
    int32_t ****length_1;
    // System.String System.Text.StringBuilder::_str
    String_t* ****str_2;
    // System.String System.Text.StringBuilder::_cached_str
    String_t* ****cached_str_3;
    // System.Int32 System.Text.StringBuilder::_maxCapacity
    int32_t ****maxCapacity_4;
};

// System.Void MyData::.ctor()
extern "C" void MyData**ctor_m0 (MyData_t2 * **this, const MethodInfo* method)
{
    ...
}

// Thing
struct Thing_t24 : public MonoBehaviour_t25
{
    // MyData Thing::m_Data
    MyData_t2 * **_m_Data_2;
    // System.Text.StringBuilder Thing::m_Builder
    StringBuilder_t26 * **_m_Builder_3;
};
struct Thing_t24_StaticFields
{
    // System.Int32 Thing::s_SomeStaticField
    int32_t **_s_SomeStaticField_4;
};
</code></pre>

<h2>观察变量值</h2>

<p>调试最重要的部分之一是观察各种变量的值。Visual Studio 允许将鼠标悬停在变量上以将变量添加到监视窗口中，从而通过相对容易的方式观察变量的值。例如：</p>

<p><img src="../uploads/Main/IL2CPP_Debugging_1.png" alt="">
<img src="../uploads/Main/IL2CPP_Debugging_2.png" alt=""></p>

<p>Observing static fields is a little bit harder. In IL2CPP, static fields are stored on a TypeInfo instance itself. So in order to observe a static field, we’ll first need a pointer to TypeInfo structure of that type. These pointers are in scope of methods that use them, but after observing it once, it will remain at the same memory address for the duration of application run. TypeInfo structure has “static_fields” field, which is a pointer to a memory block containing static fields for that particular type. To view the actual values, this pointer has to be cast to appropriate static field structure: each type has its own. For example, let’s observe the static fields of class <code>Thing_t24</code>:</p>

<figure>
<img src="../uploads/Main/IL2CPP_Debugging_3.png" alt="">
</figure>

<h2>调查异常</h2>

<p>IL2CPP 使用本机 C++ 异常来实现 .NET 异常。当应该抛出某种异常时，IL2CPP 将抛出 Il2CppExceptionWrapper 对象，其定义如下：</p>

<pre><code>struct Il2CppExceptionWrapper
{
    Il2CppException* ex;

    Il2CppExceptionWrapper (Il2CppException* ex) : ex (ex) {}
};
</code></pre>

<p>可在监视窗口中轻松调查这些异常对象：</p>

<figure>
<img src="../uploads/Main/IL2CPP_Debugging_4.png" alt="">
</figure>

<p>最后，对异常启用调试器中断，从而能够当场捕获异常的来源，这样可能有助于发现问题。为此，请在 Visual Studio 中按 CTRL+ALT+E，并确保在打开的窗口中选中了 C++ Exceptions 复选框：</p>

<figure>
<img src="../uploads/Main/IL2CPP_Debugging_5.png" alt="">
</figure>

<p>启用此设置后，只要有异常抛出，Visual Studio 就会自动停止执行：</p>

<figure>
<img src="../uploads/Main/IL2CPP_Debugging_6.png" alt="">
</figure>
<div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="windowsstore-plugins-il2cpp.html"></a></span><div class="tip">Windows Store: Plugins on IL2CPP Scripting Backend</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="windowsstore-faq.html"></a></span><div class="tip">常见问题解答</div>
</div>
</div>
</div>
<div class="footer-wrapper">
<div class="footer clear">
<div class="copy">Copyright © 2017 Unity Technologies. Publication 5.6</div>
<div class="menu">
<a href="http://unity3d.com/learn">教程</a><a href="http://answers.unity3d.com">社区答案</a><a href="https://support.unity3d.com/hc/en-us">知识库</a><a href="http://forum.unity3d.com">论坛</a><a href="http://unity3d.com/asset-store">Asset Store</a>
</div>
</div>
<div></div>
</div>
</div></div></div>
</div>
</body>
</html>
