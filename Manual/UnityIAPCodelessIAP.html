<!DOCTYPE html><html class="no-js">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-MC35ML');
    </script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="twitter:card" content="summary">
<meta name="robots" content="noindex">
<meta property="og:title" content="Codeless IAP - Unity Manual">
<title>Codeless IAP - Unity Manual</title>
<meta property="og:image" content="https://docs.unity3d.com/zh_CN/5.6/uploads/Main/Codeless%20IAP%20Getting%20Started%20Guide_image_0.png">
<meta name="description" content="Codeless IAP is the easiest way to integrate in-app purchases in your Unity app. You can use the Unity Editor to set up basic IAP integration using minimal script writing.">
<meta property="og:description" content="Codeless IAP is the easiest way to integrate in-app purchases in your Unity app. You can use the Unity Editor to set up basic IAP integration using minimal script writing.">
<meta name="author" content="Unity Technologies">
<link rel="shortcut icon" href="../StaticFiles/images/favicons/favicon.ico">
<link rel="icon" type="image/png" href="../StaticFiles/images/favicons/favicon.png">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="../StaticFiles/images/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../StaticFiles/images/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="../StaticFiles/images/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../StaticFiles/images/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="../StaticFiles/images/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon-precomposed" href="../StaticFiles/images/favicons/apple-touch-icon.png">
<meta name="msapplication-TileColor" content="#222c37">
<meta name="msapplication-TileImage" content="../StaticFiles/images/favicons/tileicon-144x144.png">
<script>
      var docs_type = 'Manual';
      var lang = 'zh_CN';
      var page = 'UnityIAPCodelessIAP';
      if(!page) page = 'index';
      var version = '560';
      var docs_versions = [{version: '2019.1',version_string: '2019.1'},{version: '2018.4',version_string: '2018.4'},{version: '2018.3',version_string: '2018.3'},{version: '2018.2',version_string: '2018.2'},{version: '2018.1',version_string: '2018.1'},{version: '2017.4',version_string: '2017.4'},{version: '2017.3',version_string: '2017.3'},{version: '2017.2',version_string: '2017.2'},{version: '2017.1',version_string: '2017.1'},{version: '5.6',version_string: '560'},];</script><script type="text/javascript" src="../StaticFiles/js/jquery.js"></script><script type="text/javascript" src="../StaticFiles/js/core.js"></script><script type="text/javascript" src="../StaticFiles/js/jquery.sidebar.min.js"></script><script type="text/javascript" src="docdata/toc.js"></script><script type="text/javascript" src=""></script><script type="text/javascript" src="../StaticFiles/js/custom.js"></script><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700,400italic" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="../StaticFiles/css/core.css">
<link rel="stylesheet" type="text/css" href="../StaticFiles/css/custom.css">
</head>
<body>
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MC35ML" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<div class="header-wrapper">
<div id="header" class="header"><div class="content">
<div class="spacer"><div class="menu">
<div id="nav-open" for="nav-input"><span></span></div>
<div class="logo"><a href="http://docs.unity3d.com"></a></div>
<div class="search-form"><form action="30_search.html" method="get" class="apisearch">
<input type="text" name="q" placeholder="Search manual..." autosave="Unity Reference" results="5" class="sbox field" id="q"><input type="submit" class="submit">
</form></div>
<ul class="menu-items">
<li class="menu-item"><a href="../Manual/index.html" class="selected">Manual</a></li>
<li class="menu-item"><a href="../ScriptReference/index.html" class="">Scripting API</a></li>
</ul>
</div></div>
<div class="more">
<div class="filler"></div>
<ul><li><a href="https://unity3d.com/">
                unity3d.com
              </a></li></ul>
</div>
</div></div>
<div class="toolbar"><div class="content">
<div class="version-switcher">
<div class="current toggle" data-target=".version-list"><div class="version-number">
<div class="d-inline-block">
          Version:
          <b>5.6</b>
</div>
<div class="d-inline-block arrow"></div>
</div></div>
<div class="version-list" style="display:none;"><ul>
<li><a class="docs_version_url_2019.1" href="/zh_CN/2019.1/Manual/UnityIAPCodelessIAP.html">2019.1</a></li>
<li><a class="docs_version_url_2018.4" href="/zh_CN/2018.4/Manual/UnityIAPCodelessIAP.html">2018.4</a></li>
<li><a class="docs_version_url_2018.3" href="/zh_CN/2018.3/Manual/UnityIAPCodelessIAP.html">2018.3</a></li>
<li><a class="docs_version_url_2018.2" href="/zh_CN/2018.2/Manual/UnityIAPCodelessIAP.html">2018.2</a></li>
<li><a class="docs_version_url_2018.1" href="/zh_CN/2018.1/Manual/UnityIAPCodelessIAP.html">2018.1</a></li>
<li><a class="docs_version_url_2017.4" href="/zh_CN/2017.4/Manual/UnityIAPCodelessIAP.html">2017.4</a></li>
<li><a class="docs_version_url_2017.3" href="/zh_CN/2017.3/Manual/UnityIAPCodelessIAP.html">2017.3</a></li>
<li><a class="docs_version_url_2017.2" href="/zh_CN/2017.2/Manual/UnityIAPCodelessIAP.html">2017.2</a></li>
<li><a class="docs_version_url_2017.1" href="/zh_CN/2017.1/Manual/UnityIAPCodelessIAP.html">2017.1</a></li>
<li><a class="docs_version_url_560" href="/zh_CN/560/Manual/UnityIAPCodelessIAP.html">5.6</a></li>
</ul></div>
</div>
<ul class="nav-menu-items">
<li class="menu-item"><a href="../Manual/index.html" class="selected">Manual</a></li>
<li class="menu-item"><a href="../ScriptReference/index.html" class="">Scripting API</a></li>
</ul>
<div class="lang-switcher">
<div class="current toggle" data-target=".lang-list">
<div class="lbl">Language:
        <span class="b">中文</span>
</div>
<div class="arrow"></div>
</div>
<div class="lang-list" style="display:none;"><ul>
<li><a data-lang="en" href="/560/Documentation/Manual/UnityIAPCodelessIAP.html">English</a></li>
<li><a data-lang="ja" href="/ja/560/Manual/UnityIAPCodelessIAP.html">日本語</a></li>
<li><a data-lang="es" href="/es/560/Manual/UnityIAPCodelessIAP.html">Español</a></li>
<li><a data-lang="kr" href="/kr/560/Manual/UnityIAPCodelessIAP.html">한국어</a></li>
</ul></div>
</div>
</div></div>
</div>
<div id="master-wrapper" class="master-wrapper clear">
<div id="sidebar" class="sidebar hidden"><div class="sidebar-wrap"><div class="content"><div class="sidebar-menu"><div class="toc">
<h2>Manual</h2>
<div class="version-switcher">
<div class="current toggle" data-target=".version-list"><div class="version-number">
<div class="d-inline-block">
          Version:
          <b>5.6</b>
</div>
<div class="d-inline-block arrow"></div>
</div></div>
<div class="version-list" style="display:none;"><ul>
<li><a class="docs_version_url_2019.1" href="/zh_CN/2019.1/Manual/UnityIAPCodelessIAP.html">2019.1</a></li>
<li><a class="docs_version_url_2018.4" href="/zh_CN/2018.4/Manual/UnityIAPCodelessIAP.html">2018.4</a></li>
<li><a class="docs_version_url_2018.3" href="/zh_CN/2018.3/Manual/UnityIAPCodelessIAP.html">2018.3</a></li>
<li><a class="docs_version_url_2018.2" href="/zh_CN/2018.2/Manual/UnityIAPCodelessIAP.html">2018.2</a></li>
<li><a class="docs_version_url_2018.1" href="/zh_CN/2018.1/Manual/UnityIAPCodelessIAP.html">2018.1</a></li>
<li><a class="docs_version_url_2017.4" href="/zh_CN/2017.4/Manual/UnityIAPCodelessIAP.html">2017.4</a></li>
<li><a class="docs_version_url_2017.3" href="/zh_CN/2017.3/Manual/UnityIAPCodelessIAP.html">2017.3</a></li>
<li><a class="docs_version_url_2017.2" href="/zh_CN/2017.2/Manual/UnityIAPCodelessIAP.html">2017.2</a></li>
<li><a class="docs_version_url_2017.1" href="/zh_CN/2017.1/Manual/UnityIAPCodelessIAP.html">2017.1</a></li>
<li><a class="docs_version_url_560" href="/zh_CN/560/Manual/UnityIAPCodelessIAP.html">5.6</a></li>
</ul></div>
</div>
<div class="clear"></div>
</div></div></div></div></div>
<div id="content-wrap" class="content-wrap opened-sidebar"><div class="content-block"><div class="content">
<div class="section">
<div class="breadcrumbs clear"><ul>
<li><a href="UnityManual.html">Unity User Manual (5.6)</a></li>
<li><a href="UnityServices.html">Unity 服务</a></li>
<li><a href="UnityIAP.html">Unity IAP</a></li>
<li>跨平台指南</li>
<li>Codeless IAP</li>
</ul></div>
<div class="mb20"><div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="UnityIAPMoolahConfiguringMooStore.html"></a></span><div class="tip">Configuring for CloudMoolah MOO Store</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="UnityIAPDefiningProducts.html"></a></span><div class="tip">定义商品</div>
</div>
</div></div>
<h1>Codeless IAP</h1>
<!--BeginSwitchLink--><!--EndSwitchLink-->
<div class="clear"></div>

<p>Codeless IAP is the easiest way to integrate in-app purchases in your Unity app. You can use the Unity Editor to set up basic IAP integration using minimal script writing.</p>

<p>Codeless IAP is “codeless” in that you don’t need write code to perform the actual IAP transaction. Once the IAP transaction is completed, you do need to define how users are granted access to their newly purchased product via scripting. However, you may not need to do scripting if, for example, you use a GameObject from the Asset Store with a suitable script for receiving messages that results in the user accumulating in-game wealth.</p>

<p>Note that you can access extended functionality through scripting - see <a href="#ExtendedFunctionality">accessing Unity IAP’s extended functionality</a> below for more information.</p>

<p>For further information and the opportunity to give feedback and ask questions, visit the <a href="https://forum.unity3d.com/threads/ann-codeless-iap-for-unity-iap.443277/">Unity IAP forums</a>.</p>

<h2>Using Codeless IAP</h2>

<p>Add IAP Buttons to your app and define your products in the IAP Catalog. Then, when players run your game, the Unity Purchasing system is configured based on the products you entered in the catalog. When a player taps or clicks on an IAP Button, it initiates a purchase of the associated product.</p>

<h3>Setup</h3>

<p><strong>Note:</strong> Before following these guides, ensure you have the Unity IAP plugin installed. See documentation on <a href="UnityIAPSettingUp.html">setting up Unity IAP</a> for more information.</p>

<figure>
<img src="../uploads/Main/Codeless%20IAP%20Getting%20Started%20Guide_image_0.png" alt="Image A: Inspector for a Button with the Codeless IAP component">
<figcaption>Image A: Inspector for a Button with the Codeless IAP component</figcaption>
</figure>

<ol>
<li><p>To add an IAP Button to your Scene, in the Unity Editor menu, select <strong>Window</strong> &gt; <strong>Unity IAP</strong> &gt; <strong>Create IAP Button</strong>.</p></li>
<li>
<p>Select your new IAP Button GameObject in the Scene view and locate the <strong>IAP Button (Script)</strong> component in the Inspector (see image A, above). Click the <strong>IAP Catalog…</strong> button to open the IAP Catalog window (see image B, below). Alternatively, in the Unity Editor menu, select <strong>Window</strong> &gt; <strong>Unity IAP</strong> &gt; <strong>IAP Catalog</strong>. </p>

<figure>
<img src="../uploads/Main/UnityIAPCodelessIAP-1.png" alt="Image B: IAP Catalog window for defining and exporting products">
<figcaption>Image B: IAP Catalog window for defining and exporting products</figcaption>
</figure>
</li>
<li><p>Define a product <strong>ID</strong> for your IAP product. This ID identifies your product with the app stores. Note that you can override this ID with a unique store-specific ID through the <strong>Advanced</strong> option.</p></li>
<li><p>Choose a product <strong>Type</strong> (products can be <strong>Consumable</strong>, <strong>Non-consumable</strong>, or <strong>Subscription</strong>).</p></li>
<li><p>Select your IAP Button GameObject again in the Scene view, and locate the <strong>IAP Button (Script)</strong> component in the Inspector (see image A, above) again.</p></li>
<li><p>Choose the product from the <strong>Product ID</strong> pop-up.</p></li>
<li><p>Either create your own function that provides purchase fulfillment using scripting or import an Asset to do this. For example, you could import an Asset from the Asset Store with a suitable IAP function (script) for receiving messages that result in the user accumulating in-game wealth. </p></li>
</ol>

<p>To do this:</p>

<ol>
<li><p>Apply your purchase fulfilment function (script) as a component to a GameObject.</p></li>
<li><p>Connect it to the <strong>On Purchase Complete (Product)</strong> event field in the component’s Inspector (see Image A, above).</p></li>
<li><p>Select <strong>+</strong> on the Inspector and and drag and drop your purchase fulfillment GameObject into the event field as shown in Image A.</p></li>
</ol>

<p>Below is an example of a simple on-purchase success function (script). For demonstration purposes, it displays the text “You Got Money!” in the Unity Editor <a href="Console.html">Console Window</a> on success. In your game, credit the user’s wallet with currency or add items to their inventory instead.</p>

<pre><code>using UnityEngine;
using UnityEngine.Purchasing;

    public class DemoInventory : MonoBehaviour{
        public void Fulfill (Product product){
            if (product != null) {
                switch (product.definition.id){
                    case "100.gold.coins":
                        Debug.Log ("You Got Money!");
                        Break;
                    Default:
                        Debug.Log (
                        string.Format ("Unrecognized productId \"{0}\"",product.definition.id)
                            );
                        Break;
                    }
                }
            }
        }
</code></pre>

<p>Finally, run your game to test the IAP Button.</p>

<p>See the Advanced section, below, for additional information on run time and export-related settings in the the IAP Catalog window. </p>

<h4>Advanced</h4>

<figure>
<img src="../uploads/Main/Codeless%20IAP%20Getting%20Started%20Guide_image_1.png" alt="Image C: The IAP Catalog window with the Advanced section folded out">
<figcaption>Image C: The IAP Catalog window with the Advanced section folded out</figcaption>
</figure>

<p>Access the Advanced section by clicking on the arrow icon next to <strong>Advanced</strong> in the IAP Catalog window.</p>

<p>Advanced fields customize a product with store-specific detail. You can fill out the advanced fields to provide a title and description for your IAP products, override a product’s ID for a particular store, and provide pricing information. After providing this information, you can export the catalog.</p>

<p><strong>Runtime-related functions</strong><br>
To define an IAP, you must input its generic identifier.</p>

<p>The Unity Editor and app stores use this generic identifier by default. However, you can use the <strong>Store ID Override</strong> section if you need to specify a unique identifier for a specific store. </p>

<p><strong>Export-related functions</strong><br>
When you want to declare or publish a text list of IAP identifiers with an app store, you have to go to that store’s website and enter all the IAP details including the store-specific ID, title, description, price or price tier, and any localized variants to be sold in non-US regions.</p>

<p>For Google Play and the Apple app stores, you can use the <strong>Google Configuration</strong> or <strong>Apple Configuration</strong> section respectively to do this from within the Unity Editor.</p>

<p>The <strong>Translations</strong> section provides localization functionality for Google configuration.</p>

<h4>Export</h4>

<p>After customizing your products with store-specific details, you can export the entire catalog as a .csv file to upload to Google Play, or as a text file for import through Apple’s Application Loader to the iTunes Store. </p>

<p>For guidance on uploading to Google Play, see the <a href="https://developer.android.com/google/play/billing/billing_admin.html#billing-list-setup">Google in-app billing documentation</a> on the <a href="https://developer.android.com">Android Developers website</a>. For guidance on importing through Apple’s Application Loader, see the <a href="https://itunesconnect.apple.com/docs/UsingApplicationLoader.pdf">Application Loader documentation</a> on the <a href="https://itunesconnect.apple.com">iTunes Connect website</a>.</p>

<p><a name="ExtendedFunctionality"></a></p>

<h3>访问 Unity IAP 的扩展功能</h3>

<p>None of Unity IAP’s <a href="UnityIAPStoreExtensions.html">extended features</a> are exposed through the Codeless IAP feature. This includes non-consumable purchase restoration for the Apple App Store (see the sample class below). </p>

<p>However, through Unity’s <a href="ScriptingConcepts.html">API scripting</a>, you can edit the source for IAPButton.cs. You can access the Unity IAP <a href="../ScriptReference/Purchasing.IStoreController.html">IStoreController</a> and <a href="Purchasing.IExtensionProvider.html">IExtensionProvider</a> instances returned by <a href="../ScriptReference/Purchasing.IStoreListener.OnInitialized.html">IStoreListener.OnInitialize</a> to use Unity IAP’s extended functionality. Codeless IAP is an implementation on top of the existing scripting APIs, where you can augment much of Codeless IAP functionality to make it do what you want it to.</p>

<h4>Apple App Store: Non-consumable purchase restoration example</h4>

<p>The sample class below demonstrates how to access <code>IAppleExtensions</code> in order to use the purchase restoration feature:</p>

<pre><code>using UnityEngine;
using UnityEngine.Purchasing;

public class AppleRestoreTransactions : MonoBehaviour {
    public void RestoreTransactions() {
        if (Application.platform == RuntimePlatform.OSXPlayer 
            || Application.platform == RuntimePlatform.IPhonePlayer 
            || Application.platform == RuntimePlatform.tvOS) {
            IAppleExtensions extensions = IAPButton.IAPButtonStoreManager.Instance.ExtensionProvider.GetExtension&lt;IAppleExtensions&gt;();
            extensions.RestoreTransactions(OnTransactionsRestored);
        }
    }
    private void OnTransactionsRestored(bool success) {
        Debug.Log("Transactions restored " + success.ToString());
    }
}
</code></pre>
<div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="UnityIAPMoolahConfiguringMooStore.html"></a></span><div class="tip">Configuring for CloudMoolah MOO Store</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="UnityIAPDefiningProducts.html"></a></span><div class="tip">定义商品</div>
</div>
</div>
</div>
<div class="footer-wrapper">
<div class="footer clear">
<div class="copy">Copyright © 2017 Unity Technologies. Publication 5.6</div>
<div class="menu">
<a href="http://unity3d.com/learn">Tutorials</a><a href="http://answers.unity3d.com">Community Answers</a><a href="https://support.unity3d.com/hc/en-us">Knowledge Base</a><a href="http://forum.unity3d.com">Forums</a><a href="http://unity3d.com/asset-store">Asset Store</a>
</div>
</div>
<div></div>
</div>
</div></div></div>
</div>
</body>
</html>
